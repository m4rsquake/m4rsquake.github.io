[{"content":" å‰è¨€ # è™½ç„¶æ ‘è“æ´¾4Bçš„æ€§èƒ½ç›¸å¯¹è¾ƒå¼ºï¼Œä½†å…¶ç½‘ç»œæ¥å£çš„æ€§èƒ½å´å¹¶ä¸ç®—ä¼˜ç§€ï¼Œå¯ä½œä¸ºç™¾å…†æ— çº¿è·¯ç”±å™¨ã€‚ ä½¿ç”¨ docker éƒ¨ç½² openWrtï¼Œå¯ä»¥åœ¨æ ‘è“æ´¾ä½œä¸ºè·¯ç”±å™¨çš„åŒæ—¶ï¼Œéƒ¨ç½²å…¶ä»–æœåŠ¡ã€‚æ³¨æ„ï¼šè¯¥æ–¹æ¡ˆæŠ˜è…¾å¤§äºä½¿ç”¨ï¼Œä½¿ç”¨ docker å¤šåˆä¸€å¯èƒ½ä¼šå¯¼è‡´æ— çº¿è½¯è·¯ç”±ä¸ç¨³å®šã€‚\nå‡†å¤‡å·¥ä½œ # æ ‘è“æ´¾ sdå¡ æ ‘è“æ´¾ç³»ç»Ÿ 1. æ›´æ¢æ ‘è“æ´¾OSè½¯ä»¶æº # ç›´æ¥æ ¹æ®ä»¥ä¸‹ç½‘å€æ¢æº raspbian | é•œåƒç«™ä½¿ç”¨å¸®åŠ© | æ¸…åå¤§å­¦å¼€æºè½¯ä»¶é•œåƒç«™ | Tsinghua Open Source Mirror\n2. å¼€å¯ä»¥å¤ªç½‘ç½‘å¡æ··æ‚æ¨¡å¼ # $sudo nano /etc/network/interfaces #ä¿®æ”¹ä¸ºï¼ˆæ·»åŠ ï¼‰ä»¥ä¸‹å†…å®¹ # interfaces(5) file used by ifup(8) and ifdown(8) # Include files from /etc/network/interfaces.d: source /etc/network/interfaces.d/* auto eth0 allow-hotplug eth0 iface eth0 inet dhcp up ip link set eth0 promisc on 3. å¼€å¯æ— çº¿çƒ­ç‚¹ï¼ˆAPï¼‰ # é€šè¿‡å›¾å½¢ç•Œé¢åˆ›å»ºä¸€ä¸ªçƒ­ç‚¹ï¼Œå¹¶é…ç½®é™æ€v4åœ°å€ä¸º 192.168.0.254\n4. å®‰è£…dockerå¹¶é…ç½® # sudo apt update -y sudo apt install docker.io -y sudo systemctl enable docker sudo systemctl start docker # å°†å½“å‰ç”¨æˆ·åŠ å…¥dockerç”¨æˆ·ç»„ sudo gpasswd -a $USER docker newgrp docker sudo modprobe veth 5. åˆ›å»ºdockerç½‘ç»œ # docker network create -d macvlan --subnet=192.168.0.0/24 --gateway=192.168.0.253 -o parent=wlan0 macwan docker network create -d macvlan --subnet=x.x.x.x/24 --gateway=x.x.x.x -o parent=eth0 macwan æ³¨æ„ï¼Œæ­¤å¤„çš„macwanç½‘ç»œçš„å­ç½‘ä¸ç½‘å…³éœ€è¦å’Œä½ å½“å‰çš„è·¯ç”±å™¨å­ç½‘ç›¸åŒï¼ŒåŸå› æ˜¯dockeråœ¨åˆ›å»ºç½‘ç»œæ—¶å¼ºåˆ¶è¦æ±‚\n6. åˆ›å»ºcontainer # docker run --restart always --name openwrt -d --network maclan --privileged --ip 192.168.0.1 \u0026#34;registry.cn-shanghai.aliyuncs.com/suling/openwrt:rpi4\u0026#34; /sbin/init æ­¤å¤„å®¹å™¨é•œåƒåœ°å€ä¸ºopenwrtçš„ç®€ä¸­immoralrtï¼Œç½‘å€ä¸ºåœ¨æ ‘è“æ´¾ä¸Šä½¿ç”¨Dockersè¿è¡ŒOpenwrtå¹¶ä½œä¸ºä¸»è·¯ç”±å™¨çš„æ—è·¯ - HXSup (ahsup.top) 7. ä¿®æ”¹dockerç½‘ç»œé…ç½® # # è¿›å…¥å®¹å™¨ docker exec -it openwrt /bin/sh # vi /etc/config/network ä¸»è¦ä¿®æ”¹æˆå¦‚ä¸‹æ‰€ç¤ºï¼š\nconfig interface \u0026#39;lan\u0026#39; option type \u0026#39;bridge\u0026#39; option ifname \u0026#39;eth0\u0026#39; option proto \u0026#39;static\u0026#39; option ipaddr \u0026#39;192.168.0.1\u0026#39; option netmask \u0026#39;255.255.255.0\u0026#39; option ip6assign \u0026#39;60\u0026#39; ä¿®æ”¹å®Œæˆåï¼Œé‡å¯ç½‘ç»œ\n/etc/init.d/network restart 8. è¿æ¥macwanåˆ°containerï¼ˆhostï¼‰ # docker network connect macwan openwrt 9. è¿›å…¥openwrtæ§åˆ¶å° # ä½¿ç”¨å¦ä¸€å°è®¾å¤‡è¿æ¥æ ‘è“æ´¾APï¼Œå¹¶åœ¨æµè§ˆå™¨è¾“å…¥192.168.0.1è¿›å…¥openwrtæ§åˆ¶å°ï¼Œå¦‚æœæ— æ³•è¿›å…¥ï¼Œæ£€æŸ¥æœ¬æœºå¾—åˆ°çš„ipæ˜¯å¦å’Œæ ‘è“æ´¾APçš„ipåœ°å€ä¸ºåŒä¸€ç½‘æ®µï¼Œä¸æ˜¯åˆ™æ‰‹åŠ¨è¾“å…¥\nè¿›å…¥åæ·»åŠ ç½‘ç»œæ¥å£WAN\nå¹¶é€‰æ‹©åŒ…æ‹¬æ¥å£ä¸ºeth1\næœ€åä¿å­˜å¹¶åº”ç”¨ï¼Œå‘ç°è„¸ä¸Šæ ‘è“æ´¾APçš„è®¾å¤‡å·²ç»èƒ½è”ç½‘ï¼\n","externalUrl":null,"permalink":"/article/raspberrypi_docker_wifi/","section":"m4rsquake çš„å…¨éƒ¨æ–‡ç« ","summary":"\u003ch3 class=\"relative group\"\u003eå‰è¨€ \n    \u003cdiv id=\"%E5%89%8D%E8%A8%80\" class=\"anchor\"\u003e\u003c/div\u003e\n    \n    \u003cspan\n        class=\"absolute top-0 w-6 transition-opacity opacity-0 ltr:-left-6 rtl:-right-6 not-prose group-hover:opacity-100\"\u003e\n        \u003ca class=\"group-hover:text-primary-300 dark:group-hover:text-neutral-700\"\n            style=\"text-decoration-line: none !important;\" href=\"#%E5%89%8D%E8%A8%80\" aria-label=\"é”šç‚¹\"\u003e#\u003c/a\u003e\n    \u003c/span\u003e        \n    \n\u003c/h3\u003e\n\u003cp\u003eè™½ç„¶æ ‘è“æ´¾4Bçš„æ€§èƒ½ç›¸å¯¹è¾ƒå¼ºï¼Œä½†å…¶ç½‘ç»œæ¥å£çš„æ€§èƒ½å´å¹¶ä¸ç®—ä¼˜ç§€ï¼Œå¯ä½œä¸ºç™¾å…†æ— çº¿è·¯ç”±å™¨ã€‚\nä½¿ç”¨ docker éƒ¨ç½² openWrtï¼Œå¯ä»¥åœ¨æ ‘è“æ´¾ä½œä¸ºè·¯ç”±å™¨çš„åŒæ—¶ï¼Œéƒ¨ç½²å…¶ä»–æœåŠ¡ã€‚æ³¨æ„ï¼šè¯¥æ–¹æ¡ˆæŠ˜è…¾å¤§äºä½¿ç”¨ï¼Œä½¿ç”¨ docker å¤šåˆä¸€å¯èƒ½ä¼šå¯¼è‡´æ— çº¿è½¯è·¯ç”±ä¸ç¨³å®šã€‚\u003c/p\u003e","title":"æ ‘è“æ´¾4Bä½¿ç”¨dockerè¿è¡Œopenwrtå®ç°æ— çº¿è·¯ç”±","type":"article"},{"content":"","externalUrl":null,"permalink":"/en/categories/","section":"Categories","summary":"","title":"Categories","type":"categories"},{"content":"","externalUrl":null,"permalink":"/article/","section":"m4rsquake çš„å…¨éƒ¨æ–‡ç« ","summary":"","title":"m4rsquake çš„å…¨éƒ¨æ–‡ç« ","type":"article"},{"content":"","externalUrl":null,"permalink":"/en/series/","section":"Series","summary":"","title":"Series","type":"series"},{"content":"","externalUrl":null,"permalink":"/en/tags/","section":"Tags","summary":"","title":"Tags","type":"tags"},{"content":"","externalUrl":null,"permalink":"/en/","section":"Welcome to Blowfish! ğŸ‰","summary":"","title":"Welcome to Blowfish! ğŸ‰","type":"page"},{"content":"","externalUrl":null,"permalink":"/tags/%E6%8A%98%E8%85%BE/","section":"Tags","summary":"","title":"æŠ˜è…¾","type":"tags"},{"content":"","externalUrl":null,"permalink":"/tags/%E6%95%99%E7%A8%8B/","section":"Tags","summary":"","title":"æ•™ç¨‹","type":"tags"}]